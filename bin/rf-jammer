#!/usr/bin/env node

const { program } = require('commander')
const { select, input } = require('@inquirer/prompts')

const { COMMON_RF_CONFIGURATIONS } = require('../lib/constants')

program
  .option(`-c, --common <${Object.keys(COMMON_RF_CONFIGURATIONS).join('|')}>`, 'Use a common radio channel/configuration')

const transmitRfSignal = require('./transmit-rf-signal')

const commonFrequencyOptions = Object.values(COMMON_RF_CONFIGURATIONS)
  .map(value => ({ name: value.label, value }))

const frequencyOptions = [
  ...commonFrequencyOptions,
  { name: 'Other (specify)', value: {} }
]

module.exports = async (options = {}) => {
  const { frequency, samplerate } = await select({
    message: 'Use a common frequency',
    choices: frequencyOptions
  })

  await transmitRfSignal({
    rfsignalFrequency: frequency,
    rfsignalSamplerate: samplerate
  })
}

if (require.main === module) {
  require('../lib/banner')
  module.exports(program.parse().opts())
}
